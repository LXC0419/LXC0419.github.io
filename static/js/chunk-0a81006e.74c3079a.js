(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-0a81006e"],{"83a0":function(e,t,r){"use strict";r.r(t);var a=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("PageTools",{scopedSlots:e._u([{key:"before",fn:function(){return[a("span",[e._v("共计"+e._s(e.page.total)+"条")])]},proxy:!0},{key:"after",fn:function(){return[a("el-button",{attrs:{type:"danger",size:"small"},on:{click:e.onExport}},[e._v("员工导出")]),a("el-button",{attrs:{type:"success",size:"small"},on:{click:function(t){return e.$router.push("/import")}}},[e._v("员工导入")]),a("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(t){e.showDialog=!0}}},[e._v("新增员工")])]},proxy:!0}])}),a("el-table",{attrs:{data:e.list,border:"",stripe:""}},[a("el-table-column",{attrs:{label:"序号",type:"index"}}),a("el-table-column",{attrs:{label:"姓名",prop:"username",sortable:!0}}),a("el-table-column",{attrs:{label:"头像",prop:"staffPhoto",sortable:!0},scopedSlots:e._u([{key:"default",fn:function(t){var o=t.row;return[a("img",{directives:[{name:"imgerror",rawName:"v-imgerror",value:r("a36b"),expression:"require('@/assets/404_images/404.png')"}],staticStyle:{"max-width":"110px","border-radius":"50%"},attrs:{src:o.staffPhoto,alt:""},on:{click:function(t){return e.onShowQrcodeDialog(o.staffPhoto)}}})]}}])}),a("el-table-column",{attrs:{label:"手机号",prop:"mobile",sortable:!0}}),a("el-table-column",{attrs:{label:"工号",prop:"workNumber",sortable:!0}}),a("el-table-column",{attrs:{label:"聘用形式",prop:"formOfEmployment",sortable:!0},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return[e._v(" "+e._s(e._f("formatFormOfEmployment")(r.formOfEmployment))+" ")]}}])}),a("el-table-column",{attrs:{label:"部门",prop:"departmentName",sortable:!0}}),a("el-table-column",{attrs:{label:"入职时间",prop:"timeOfEntry",sortable:!0},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return[e._v(" "+e._s(e._f("formatDate")(r.timeOfEntry))+" ")]}}])}),a("el-table-column",{attrs:{label:"状态",prop:"enableState",sortable:!0},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return[a("el-switch",{attrs:{disabled:""},model:{value:r.enableState,callback:function(t){e.$set(r,"enableState",t)},expression:"row.enableState"}})]}}])}),a("el-table-column",{attrs:{label:"操作",prop:"",sortable:!0,width:"300",fixed:"right"},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return[a("el-button",{attrs:{type:"text"},on:{click:function(t){return e.$router.push("/employess/detail/"+r.id)}}},[e._v("查看")]),a("el-button",{attrs:{type:"text"}},[e._v("转正")]),a("el-button",{attrs:{type:"text"}},[e._v("调岗")]),a("el-button",{attrs:{type:"text"}},[e._v("离职")]),a("el-button",{attrs:{type:"text"},on:{click:function(t){return e.onShowAsignRoleDialog(r.id)}}},[e._v("角色")]),a("el-button",{attrs:{type:"text"},on:{click:function(t){return e.onDel(r.id)}}},[e._v("删除")])]}}])})],1),a("el-pagination",{attrs:{layout:"total,prev, pager, next",total:e.page.total},on:{"current-change":e.CurrentChange}}),a("el-dialog",{attrs:{title:"二维码",visible:e.dialogVisible,width:"30%"},on:{"update:visible":function(t){e.dialogVisible=t}}},[a("el-row",{attrs:{type:"flex",justify:"center"}},[a("qrcode-vue",{attrs:{value:e.imgUrl,size:"100",level:"H"}})],1)],1),e.showDialog?a("AddEmp",{attrs:{"show-dialog":e.showDialog},on:{"update:showDialog":function(t){e.showDialog=t},"update:show-dialog":function(t){e.showDialog=t}}}):e._e(),a("el-dialog",{attrs:{title:"分配角色",visible:e.showAsignRoleDialog},on:{"update:visible":function(t){e.showAsignRoleDialog=t}}},[a("el-checkbox-group",{model:{value:e.selectedRoleList,callback:function(t){e.selectedRoleList=t},expression:"selectedRoleList"}},e._l(e.roleList,(function(t,r){return a("el-checkbox",{key:r,attrs:{label:t.id}},[e._v(e._s(t.name))])})),1),a("el-row",{attrs:{type:"flex",justify:"center"}},[a("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.onAsignRole}},[e._v("确定")]),a("el-button",{attrs:{type:"info",size:"small"},on:{click:function(t){e.showAsignRoleDialog=!1}}},[e._v("取消")])],1)],1)],1)},o=[],n=r("1da1"),l=(r("d3b7"),r("3ca3"),r("ddb0"),r("07ac"),r("b64b"),r("96cf"),r("365c")),s=r("90e7"),i=r("8304"),c=r("c24f"),u=r("d7b0"),m=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("el-dialog",e._g(e._b({attrs:{visible:e.showDialog,title:"Dialog Titile"},on:{open:e.onOpen,close:e.onClose}},"el-dialog",e.$attrs,!1),e.$listeners),[r("el-form",{ref:"formRef",attrs:{model:e.formData,rules:e.rules,size:"medium","label-width":"100px"}},[r("el-form-item",{attrs:{label:"姓名",prop:"username"}},[r("el-input",{style:{width:"100%"},attrs:{placeholder:"请输入姓名",clearable:""},model:{value:e.formData.username,callback:function(t){e.$set(e.formData,"username",t)},expression:"formData.username"}})],1),r("el-form-item",{attrs:{label:"手机号",prop:"mobile"}},[r("el-input",{style:{width:"100%"},attrs:{placeholder:"请输入手机号",clearable:""},model:{value:e.formData.mobile,callback:function(t){e.$set(e.formData,"mobile",t)},expression:"formData.mobile"}})],1),r("el-form-item",{attrs:{label:"入职时间",prop:"timeOfEntry"}},[r("el-date-picker",{style:{width:"100%"},attrs:{format:"yyyy-MM-dd","value-format":"yyyy-MM-dd",placeholder:"请选择入职时间",clearable:""},model:{value:e.formData.timeOfEntry,callback:function(t){e.$set(e.formData,"timeOfEntry",t)},expression:"formData.timeOfEntry"}})],1),r("el-form-item",{attrs:{label:"聘用形式",prop:"formOfEmployment"}},[r("el-select",{style:{width:"100%"},attrs:{placeholder:"请选择聘用形式",clearable:""},model:{value:e.formData.formOfEmployment,callback:function(t){e.$set(e.formData,"formOfEmployment",t)},expression:"formData.formOfEmployment"}},e._l(e.formOfEmploymentOptions,(function(e,t){return r("el-option",{key:t,attrs:{label:e.value,value:e.id,disabled:e.disabled}})})),1)],1),r("el-form-item",{attrs:{label:"工号",prop:"workNumber"}},[r("el-input",{style:{width:"100%"},attrs:{placeholder:"请输入工号",clearable:""},model:{value:e.formData.workNumber,callback:function(t){e.$set(e.formData,"workNumber",t)},expression:"formData.workNumber"}})],1),r("el-form-item",{attrs:{label:"部门",prop:"departmentName"}},[r("el-input",{style:{width:"100%"},attrs:{placeholder:"请输入部门",clearable:""},on:{focus:e.getDepts},model:{value:e.formData.departmentName,callback:function(t){e.$set(e.formData,"departmentName",t)},expression:"formData.departmentName"}}),r("el-tree",{directives:[{name:"show",rawName:"v-show",value:e.showTree,expression:"showTree"}],attrs:{data:e.depts,props:{label:"name"}},on:{"node-click":e.handleNodeClick}})],1),r("el-form-item",{attrs:{label:"转正时间",prop:"correctionTime"}},[r("el-date-picker",{style:{width:"100%"},attrs:{format:"yyyy-MM-dd","value-format":"yyyy-MM-dd",placeholder:"请选择转正时间",clearable:""},model:{value:e.formData.correctionTime,callback:function(t){e.$set(e.formData,"correctionTime",t)},expression:"formData.correctionTime"}})],1)],1),r("el-row",{attrs:{slot:"footer",type:"flex",justify:"center"},slot:"footer"},[r("el-button",{on:{click:e.onClose}},[e._v("取消")]),r("el-button",{attrs:{type:"primary"},on:{click:e.handelConfirm}},[e._v("确定")])],1)],1)],1)},p=[],f=(r("b0c0"),r("01f5")),d=r("ed08"),b={components:{},inheritAttrs:!1,props:{showDialog:{type:Boolean,required:!0}},data:function(){return{formData:{username:void 0,mobile:void 0,timeOfEntry:null,formOfEmployment:void 0,workNumber:void 0,departmentName:void 0,correctionTime:null},rules:{username:[{required:!0,message:"请输入姓名",trigger:"blur"},{min:1,max:4,message:"1-4个字符",trigger:"blur"}],mobile:[{required:!0,message:"请输入手机号",trigger:"blur"},{pattern:/^1[1-9]\d{9}$/,message:"请输入正确的手机号",trigger:"blur"}],timeOfEntry:[{required:!0,message:"请选择入职时间",trigger:"change"}],formOfEmployment:[{required:!0,message:"请选择聘用形式",trigger:"change"}],workNumber:[{required:!0,message:"请输入工号",trigger:"blur"}],departmentName:[{required:!0,message:"请输入部门",trigger:"change"}],correctionTime:[]},formOfEmploymentOptions:f["a"].hireType,depts:[],showTree:!1}},computed:{},watch:{},created:function(){},mounted:function(){},methods:{onOpen:function(){},onClose:function(){this.$refs["formRef"].resetFields(),this.$emit("update:showDialog",!1)},handelConfirm:function(){var e=this;this.$refs["formRef"].validate(function(){var t=Object(n["a"])(regeneratorRuntime.mark((function t(r){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(r){t.next=2;break}return t.abrupt("return");case 2:return t.next=4,Object(l["b"])(e.formData);case 4:e.$message.success("操作成功"),e.$parent.getEmployees(),e.onClose();case 7:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())},getDepts:function(){var e=this;return Object(n["a"])(regeneratorRuntime.mark((function t(){var r,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Object(l["i"])();case 2:r=t.sent,a=r.depts,e.depts=Object(d["b"])(a,""),e.showTree=!0;case 6:case"end":return t.stop()}}),t)})))()},handleNodeClick:function(e){this.formData.departmentName=e.name,this.showTree=!1}}},g=b,h=r("2877"),w=Object(h["a"])(g,m,p,!1,null,null,null),y=w.exports,v={name:"Employess",components:{QrcodeVue:u["a"],AddEmp:y},data:function(){return{showAsignRoleDialog:!1,roleList:[],selectedRoleList:[],currentId:void 0,list:[],page:{page:1,size:9,total:0},dialogVisible:!1,imgUrl:"",showDialog:!1,showAsignPermDialog:!1}},created:function(){this.getEmployees()},mounted:function(){},methods:{getEmployees:function(){var e=this;return Object(n["a"])(regeneratorRuntime.mark((function t(){var r,a,o;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Object(l["k"])(e.page);case 2:r=t.sent,a=r.total,o=r.rows,e.page.total=a,e.list=o;case 7:case"end":return t.stop()}}),t)})))()},CurrentChange:function(e){this.page.page=e,this.getEmployees()},onShowQrcodeDialog:function(e){this.imgUrl=e,this.dialogVisible=!0},onDel:function(e){var t=this;return Object(n["a"])(regeneratorRuntime.mark((function r(){return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:t.$confirm("确认删除？").then(function(){var r=Object(n["a"])(regeneratorRuntime.mark((function r(a){return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,Object(l["e"])(e);case 3:t.$message.success("操作成功"),r.next=9;break;case 6:r.prev=6,r.t0=r["catch"](0),t.$message.error("删除失败");case 9:case"end":return r.stop()}}),r,null,[[0,6]])})));return function(e){return r.apply(this,arguments)}}()).catch((function(e){}));case 1:case"end":return r.stop()}}),r)})))()},onExport:function(){var e=this;Promise.all([r.e("chunk-75d9ac4a"),r.e("chunk-2d0cc0b6")]).then(r.bind(null,"4bf8")).then(function(){var t=Object(n["a"])(regeneratorRuntime.mark((function t(r){var a,o,n,s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Object(l["k"])({page:1,size:e.page.total});case 2:return a=t.sent,o=a.rows,n={"手机号":"mobile","姓名":"username","入职日期":"timeOfEntry","聘用形式":"formOfEmployment","转正日期":"correctionTime","工号":"workNumber","部门":"departmentName"},t.next=7,Object(d["a"])(o,Object.values(n));case 7:s=t.sent,r.export_json_to_excel({header:Object.keys(n),data:s,filename:"excel-list",autoWidth:!0,bookType:"xlsx"});case 9:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())},onShowAsignRoleDialog:function(e){var t=this;return Object(n["a"])(regeneratorRuntime.mark((function r(){var a,o;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return t.currentId=e,r.next=3,Object(c["a"])(e);case 3:return a=r.sent,o=a.roleIds,console.log(o),t.selectedRoleList=o,r.next=9,Object(s["f"])({page:1,size:50});case 9:t.roleList=r.sent.rows,t.showAsignRoleDialog=!0;case 11:case"end":return r.stop()}}),r)})))()},onAsignRole:function(){var e=this;return Object(n["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Object(i["b"])({id:e.currentId,roleIds:e.selectedRoleList});case 2:e.$message.success("操作成功"),e.showAsignRoleDialog=!1;case 4:case"end":return t.stop()}}),t)})))()}}},k=v,x=Object(h["a"])(k,a,o,!1,null,"de97a384",null);t["default"]=x.exports},a36b:function(e,t,r){e.exports=r.p+"static/img/404.a57b6f31.png"},ed08:function(e,t,r){"use strict";r.d(t,"b",(function(){return a})),r.d(t,"a",(function(){return o}));r("53ca"),r("ac1f"),r("00b4"),r("5319"),r("4d63"),r("c607"),r("2c3e"),r("25f0"),r("d3b7"),r("4d90"),r("1276"),r("159b"),r("d81d");function a(e,t){var r=[];return e.forEach((function(o){if(t===o.pid){var n=a(e,o.id);n.length>0&&(o.children=n),r.push(o)}})),r}function o(e,t){return e.map((function(e){for(var r=[],a=0;a<t.length;a++)r.push(e[t[a]]);return r}))}}}]);